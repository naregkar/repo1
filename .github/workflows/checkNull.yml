name: checkNull

on:
    pull_request:
        types: [opened, edited, reopened, synchronize]
        branches: 
          - master
          - release
env:
  GITHUB_PR_NUMBER: ${{github.event.pull_request.number}}
  GITHUB_WORKFLOW_ID: ${{github.run_id}}
  
jobs:
  checkNull:
    runs-on: ubuntu-latest
    
    steps:

        - name: Some echo for release
          if: ${{ github.event.pull_request.base.ref == 'release' }}
          run: |
                 echo 'release branch'
    
        - name: Some echo for master
          if: ${{ github.event.pull_request.base.ref == 'master' }}
          run:  |
                 echo 'master branch'
              
              
        - name: Read Issue Type from Jira
          if: github.event_name == 'pull_request'
          run : |
                 restApiGET=$(curl --request GET \
                    --url 'https://naregkar.atlassian.net/rest/api/3/issue/DT-11/' \
                    --user 'nareg.karamanoukian@picsart.com:oBJTrxuI3qf0Do1MBpGbBE87' \
                    --header 'Accept: application/json')
                                   
                 targetBranch=${{ github.event.pull_request.base.ref }}
                 
                 labelArray=$(echo $restApiGET | jq -r '.fields.labels')
                 
                 echo 'labelArray:' $labelArray
                 
                 if [[ " ${labelArray[@]} " =~ "Showstopper" &&  $targetBranch == "release" ]]; then
                    echo 'label exists and correct target branch'
                 else
                    echo 'wrong'
                 fi
